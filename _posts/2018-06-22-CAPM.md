---
layout: post
title:  "Linear model report"
date:   2018-06-22
use_math: true
tags:
 - SAS
 - korean
 - Report
---

# CAPM으로 분석한 한국 항공 주식의 특성 및 비교

## 1. 서론

### 1-1. 프로젝트의 배경 및 목적

소득의 증대, 교통수단의 발달, '워라밸(Work and Life Balance·일과 삶의 균형)' 문화 확산은 해외여행 수요를 증가시켰고, 이는 항공사가 양적팽창을 이루는데 크게 영향을 주었다. 
한국관광공사가 발표하는 ‘한국 관광 통계’에 따르면 2018년 1월~4월 동안 해외여행을 나간 한국인 출국자 수는 966만 명 이상으로, 전년 동기 대비 13.4%가 증가했다. 
이처럼 해외여행객이 큰 폭으로 늘고 있는 것은 중·장거리 여행지보다 가까운 아시아 국가를 방문하는 해외여행객이 급증한 결과에 기인한다.
이러한 통계 결과는 저비용항공사(LCC)의 공급확대에서 찾아볼 수 있다. 저비용항공사(LCC)가 수년간 단거리 해외 노선을 중심으로 저렴한 비용으로 다녀올 수 있는 해외여행을 제안하고 소비자들이 이에 부응한 결과 여행 수요가 크게 급증하였다.

저비용항공 산업은 지난 10여 년간 가장 빨리 성장해 온 분야이다. 
IT를 제외한 대부분의 국내 산업이 쇠퇴와 정체 현상을 빚는 상황에서도 저비용항공 산업은 매년 10~20%의 성장을 꾸준하게 달성해왔다. 
이를 반영하듯 최근 국내 저비용항공사(LCC)들이 증시 상장을 준비 중이다. 
항공·증권업계에 따르면 티웨이항공과 에어부산, 이스타항공이 상장 절차를 밟고 있다고 한다. 
티웨이항공과 에어부산은 2018년내 상장을, 이스타항공은 내년 하반기 상장을 계획하고 있다.

국내 저비용항공사(LCC)들의 증시 상장이 예상되는 2018년 이후는 항공 산업 시장에 많은 변화가 있을 것으로 예상된다. 
이를 앞둔 지금 시점에서의 항공 주식 시장을 살펴보는 것은 의미 있는 작업이라 생각한다. 
이에 시장 내 항공 주식의 속성을 파악하고, 이를 바탕으로 항공사 간 비교를 하는 것을 목적으로 본 프로젝트를 진행하였다. 
그리고 이를 위해 CAPM이라는 재무경제학 이론을 활용하였다.

### 1-2. 프로젝트의 방법 및 구성

본 프로젝트에서는 2017년 1월초부터 2017년 11월말까지의 대한항공, 아시아나항공, 제주항공, KOSPI지수, 국고채(3년물)의 일간 수익률 데이터로 AR, GARCH 모형 등을 적합해 
세 항공사에 대한 CAPM 모형을 추정하였다. 
절편과 베타를 추정하고 시장 위험과 고유 위험, 샤프비를 계산해 주식의 고평가/저평가 여부를 판단하고 
시장변동에 의한 위험(체계적 위험)과 기업의 고유위험(비체계적 위험), 위험보상률인 샤프비를 도출함으로써 항공 산업의 특성을 파악하고자 하였다.

본 보고서는 다음과 같이 구성되어 있다. 제1장에서는 서론을 기술하고, 제2장에서는 CAPM 이론과 beta 추정모형에 대해 알아본다. 
제3장에서는 모형적합 과정과 결과를 설명하고, 제4장에서는 그 결과를 종합하여 분석한다. 
마지막으로 제5장에서는 본 프로젝트의 분석 결과들을 정리하고, 차후 보완 과제에 대해 논의하고자 한다.

## 2. CAPM 이론과 $beta$ 추정 모형

### 2-1. CAPM 이론

자본자산 가격결정모형(CAPM)은 일정 기간 동안 자산으로부터 얻을 수 있는 기대수익률을 측정하는데 사용되는 모형으로서, 기대수익률을 위험의 함수로 나타내고 있다.
자산수익률의 위험은 체계적 위험과 비체계적 위험으로 나누어진다.
체계적 위험(시장 위험)은 시장수익률과 연관된 위험이며 분산하여 제거할 수 없다. 비체계적 위험(고유 위험)은 자산이 갖는 고유한 위험이며, 다른 여러 자산들로 구성된 대규모 포트폴리오를 구성함으로써 제거할 수 있다. 
CAPM은 분산 투자해도 제거할 수 없는 자산의 체계적 위험만을 기준으로 자산의 기대수익률을 계산하는 모형이며 다음과 같다.

$$
E(R_i) = R_f + \beta_i[E(R_M) - R_f]
$$

여기서 $E(R_i)$ 은 주식 $i$의 기대수익률, $E(R_M)$ 은 시장 포트폴리오의 기대수익률, $R_f$ 는 무위험 수익률을 의미한다. 
그리고 $\beta_i$ 는 주식 $i$ 의 체계적 위험지수를 나타낸다.

다음은 각각의 $\beta$ 값에 상응하는 기대수익률 $E(R_i)$ 을 그린 그래프이며 이를 증권시장선(SML)이라고 부른다.

![](/assets/CAPM/1.jpg)

위의 그림에서 점 M으로 표시된 시장 포트폴리오는 $\beta$ 가 1이며 이 때의 기대수익률은 $E(R_M)$ 이다.
주식의 수익률이 그에 상응하는 $\beta$ 에서 SML선상에 있지 않으면 그 주식가격은 시장 균형을 이탈한 상태라고 할 수 있다. 
이때 수익률이 SML선 위쪽에 있으면 주식의 예상 수익률보다 크므로 가격은 저평가, 아래쪽에 있으면 고평가된 것이라 할 수 있다.

한편, CAPM은 다음과 같은 상당히 엄격한 가정을 필요로 한다.

1. 투자자들은 자산의 기대수익률과 자산수익률의 표준편차에 대해서만 관심이 있다.
2. 두 자산의 수익률은 각각이 갖는 시장수익률과의 상관관계로 인해서만 상호관련되어 있다. 이는 자산의 수익률이 하나의 요인에 의해서만 결정된다고 가정하는 것과 동등한 가정이다.
3. 투자자들은 단일 기간 동안의 수익률에 관심이 있으며, 그 기간은 모든 투자자들에게 동일하다.
4. 투자자들은 동일한 무위험수익률로 차입하고 대출한다.
5. 세금은 투자 의사결정에 영향을 미치지 않는다.
6. 모든 투자자들은 자산의 기대수익률과 표준편차 그리고 수익률 간의 상관관계에 대하여 동질적 예측을 한다.

이런 가정들은 자본시장의 매우 이상적인 조건을 나타내며 현실과는 괴리가 있다는 문제가 있다. 
이러한 한계점에도 불구하고 CAPM은 포트폴리오 매니저들에게 유용한 도구로 사용되고 있으며, 포트폴리오 매니저들의 성과를 측정하는데 벤치마크로 사용되기도 한다.

### 2-2. $\beta$ 추정 모형

#### 2-2-1. 모형 및 변수 설명

대한항공, 아시아나항공, 제주항공, KOSPI지수, 국고채 3년물의 2017년 1월부터 2017년 11월까지의 수익률 데이터를 이용하여 각 항공사 주식의 $\beta$ 계수를 추정하였다. 
다음은 추정 모형과 각 변수에 대한 설명이다.

$$
\begin{split}
&R_{i, t} - R_{f, t} = \alpha_i + \beta_i(R_{M, t} - R_{f, t}) + \epsilon \\
&i = \text{ 대한항공, 아시아나항공, 제주항공} \\
&t = 2017-01-02, 2017-01-03, \cdots 2017-11-30 \\
&R_{i, t} = \text{ 주식 } i \text{ 의 } t \text{ 시점에서의 일간수익률} (\%) \\
&R_{M, t} = \text{ 시장 포트폴리오(KOSPI지수)의 } t \text{ 시점에서의 일간수익률} \\
&R_{f, t} = \text{ 무위험자산(국고채 3년물)의 일간수익률}
\end{split}
$$

$R_{i, t}$ 는 백분율 기준의 수익률로서 다음과 같이 계산된다.
(베이시스 포인트로도 환산해보았으나 그경우 모형 적합이 잘 안 되어 부득이하게 % 단위를 썼다.)

$$
\begin{split}
&R_{i, t} = (P_{i, t} - P_{i, t-1})/P_{i, t-1} \times 100 \\
&R_{i, t} = i\text{ 주식의 } t \text{ 시점에서의 일간수익률}\\
&P_{i, t} = i\text{ 주식의 } t \text{ 시점에서의 종가}
\end{split}
$$

$R_{M, t}$ 는 KOSPI지수를 사용하였고, 계산 방식은 위 $R_{i, t}$ 와 같다.

$R_{f, t}$는 국고채(3년물)의 월별 연수익률을 일간수익률(%)로 환산한 것으로 다음과 같이 계산된다.

$$
\begin{split}
&R_{f, t} = (\sqrt[365]{1 + R_{F, t}} - 1) \times 100 \\
&R_{F, t} = \text{ 국고채 3년물의 } t \text{ 시점에서의 연간수익률} \\
&(\text{매월초 } \sim \text{ 매월말까지의 } R_{F, t} \text{ 는 동일하다고 가정})
\end{split}
$$

#### 2-2-2. 데이터 및 모형 추정 결과로 설명할 수 있는 주식 속성

1) $\hat{\alpha}_i$
한편, CAPM에 의하면 $\hat{\alpha}_i = 0$ 이어야 한다. 
만약 0보다 크면 이는 기대수익률이 SML선 위에 있는것과 같으며 주식이 저평가되었음을 의미한다. 
반대로 0보다 작으면 고평가되었음을 의미한다.

2) $\hat{\beta}_i$
추정된 $\hat{\beta}_i$ 를 통해 주식 $i$ 가 시장수익률의 변화에 대해 얼마나 민감하게 반응하는지를 알 수 있다. 
1보다 크면 수익률은 시장수익률 변동에 더 큰 변동으로 반응하며, 1보다 작으면 더 작은 변동으로 반응한다.

3) $Var(\hat{\beta}_i R_M), Var(\epsilon)$

$R_{i, t} - R_{f, t} = \alpha_i + \beta_i(R_{M, t} - R_{f, t}) + \epsilon$ 에서 $R_{i}$ 의 총변동(위험인) $Var(R_{i, t})$ 에서
$Var(\hat{\beta}_i R_M)$ 는 시장수익률의 변동에 의한 부분, 즉 시장 변화에 의한 위험을 나타내고, 
$Var(\epsilon)$ 는 설명변수로는 설명되지 않는 부분, 즉 기업 고유의 위험을 나타낸다.

4) $E(R_i - R_f), E(R_i - R_f)/\sigma_i$
전자는 위험을 감수하고 주식 $i$ 에 투자함으로써, 위험을 감수하지 않고도 얻을 수 있는 수익률 $R_f$에 더해 추가로 얻을 수 있는 수익률, 즉 '위험 프리미엄'을 의미한다. 
후자는 '샤프비'라고 하는 것으로, ($R_i$ 의 표준편차로 표현된)위험 대비 얼마나 큰 프리미엄을 주는지를 뜻하며 투자효율의 지표가 된다.

## 3. 모형 적합

### 3-1. 적합 과정

다음은 대한항공, 아시아나, 제주항공 중 아시아나의 모형 적합 과정이다. 
대한항공과 제주항공 역시 마찬가지 방식으로 진행되므로 과정 설명은 생략하고 최종 모형만을 밝힌다.

$$
\text{아시아나 추정 모형 : } R_{t} - R_{f, t} = \alpha + \beta(R_{M, t} - R_{f, t}) + \epsilon
$$

#### 3-1-1. 모형의 자기상관 여부

```sas
proc import datafile="C:\Users\lg\Desktop\model_data.xlsx"
     out=data_daily replace;
     getnames=yes;
run;

data stock1; set data_daily; index = _n_; run;
data stock11; set stock1;index>=268;run;

/*modeling*/
proc autoreg data=stock11;
 model asiana_er = kospi_er/nlag=20 backstep; 
run;

/*modeling*/
proc autoreg data=stock11;
 model asiana_er = kospi_er/nlag=(16);
 output out=resid_out r=resid;
run;

/*자기상관여부_Q-test*/
proc arima data = resid_out;
 identify var=resid nlag=30;run;

/*조건부 자기상관*/
data resid_out; set resid_out;
 resid_s = resid**2;run;

proc arima data=resid_out;
identify var=resid_s nlag=30;run;quit;
```

![](/assets/CAPM/2.jpg)

![](/assets/CAPM/3.jpg)

![](/assets/CAPM/4.jpg)

$\hat{\alpha}$ 에 대한 t-test의 p-value가 0.9612 이므로 $H_0 : \alpha = 0$ 을 기각하지 못한다.
따라서 $\hat{\alpha} = 0$ 으로 놓고 다시 적합하면,

![](/assets/CAPM/5.jpg)

위와 같이 나오며 모델식은 

$$
\hat{R_t - R_{f, t}} = 0.8864(R_{m, t} - R_{f, t}) + \hat{\epsilon}_t, \hat{\epsilon}_t = 0.267434 \cdot \hat{\epsilon}_{t - 16} + \nu_t
$$

이고 그래프 및 자기상관 여부는 아래의 그림들과 같다.

![](/assets/CAPM/6.jpg)
![](/assets/CAPM/7.jpg)
![](/assets/CAPM/8.jpg)

위 결과를 보면, Q-검정에 의해 변동성에 대해 자기상관이 있는 것으로 나타났다. 
따라서 변동성 모형을 적합시키기 위해 GARCH(1, 1) 모형을 적합해보았다.

#### 3-1-2. GARCH(1, 1) 모형

```sas
/*garch*/
proc autoreg data=stock11;
 model asiana_er = kospi_er/nlag=(16) garch=(p=1, q=1) dist=t;
 output out=garch_out r=resid p=pred lcl=L95 ucl=U95 cev=HT1 cpev=HT2;
run;
```

![](/assets/CAPM/9.jpg)
![](/assets/CAPM/10.jpg)

위 모델식은 

$$
\hat{R_t - R_{f, t}} = 0.82 \cdot (R_{m, t} - R_{f, t}) + \hat{\epsilon}_t, \hat{\epsilon}_t = 0.1474 \cdot \hat{\epsilon}_{t - 16} + \hat{\nu}_t, \hat{\nu}_t = \hat{\sigma}_t\hat{\alpha}_t, \hat{\sigma}^2_t = 0.0965 + 0.0624 \cdot \hat{\nu}^2_t + 0.9232 \cdot \hat{\sigma}^2_t
$$ 

이다. 이 GARCH(1, 1)모델에 대한 진단이 필요하기 때문에 위 모델식에 의해 얻어진 잔차의 제곱인 $\hat{\alpha}^2_t$ 에 자기 상관이 존재하는지에 대한 검정 결과는 다음과 같다.

```sas
/*garch 검진*/
data garch_out; set garch_out;
 AT=resid/sqrt(HT1); AT2=AT**2; run;

proc arima data=garch_out;
 identify var=AT nlag=30;
 identify var=AT2 nlag=30;run; quit;
```

![](/assets/CAPM/11.jpg)

AR(16)과 GARCH(1, 1)으로도 조건부 이분산을 잡을 수가 없었기 때문에 ARCH부분과 GARCH부분을 늘려보았지만 여전히 잡아낼 수 가 없었다. 
이는 처음 AR 부분에서 설명력이 떨어진 탓이라는 생각에 AR계수를 늘려보았다.

다음은 AR(13, 16)과 GARCH(1, 1)으로 적합시켜본 결과이다.

![](/assets/CAPM/12.jpg)
![](/assets/CAPM/13.jpg)

위 모델식은  

$$
\hat{R_t - R_{f, t}} = 0.7772 \cdot (R_{m, t} - R_{f, t}) + \hat{\epsilon}_t, \hat{\epsilon}_t = 0.0811 \cdot \hat{\epsilon}_{t - 13} + 0.1411 \cdot \hat{\epsilon}_{t - 16} + \hat{\nu}_t, \hat{\nu}_t = \hat{\sigma}_t\hat{\alpha}_t, \hat{\sigma}^2_t = 0.1009 + 0.0642 \cdot \hat{\nu}^2_t + 0.9198 \cdot \hat{\sigma}^2_t
$$

이며 AR13의 계수는 유의하지 않았지만 그럼에도 불구하고 조건부 이분산을 잡을 수가 있었다.
또한 $\alpha+1 + \delta_1 \cong 1$ 로 1에 매우 가깝기 때문에 IGARCH 모형의 적합을 고려해보았다.

#### 3-1-3. IGARCH(1, 1) 모형

```sas
/*i-garch*/
proc autoreg data=stock11;
 model asiana_er = kospi_er/nlag=(16) garch=(p=1,q=1,type=INTEG, noint) dist=t;
 output out=garch_out r=resid p=pred lcl=L95 ucl=U95 cev=HT1 cpev=HT2;
run;

/*i-garch 검진*/
data garch_out; set garch_out;
 AT=resid/sqrt(HT1); AT2=AT**2; run;

proc arima data=garch_out;
 identify var=AT nlag=30;
 identify var=AT2 nlag=30;run; quit;
```

![](/assets/CAPM/14.jpg)

그 결과 AR13 부분이 유의하지는 않았지만 $\alpha_1, \delta_1$ 이 전부 유의하게 나왔으며 잔차의 자기상관이나 조건부 이분산을 해결할 수 있었다. 
이에 더해, 변수의 갯수를 줄이고자 AR13을 제거한 상태에서 다시 적합을 해보았다.

![](/assets/CAPM/15.jpg)
![](/assets/CAPM/16.jpg)
![](/assets/CAPM/17.jpg)
![](/assets/CAPM/18.jpg)

그 결과 추정된 모델식은 

$$
\hat{R_t - R_{f, t}} = 0.8369 \cdot (R_{m, t} - R_{f, t}) + \hat{\epsilon}_t, \hat{\epsilon}_t = 0.1572 \cdot \hat{\epsilon}_{t - 16} + \hat{\nu}_t, \hat{\nu}_t = \hat{\sigma}_t\hat{\alpha}_t, \hat{\sigma}^2_t = 0.0459 \cdot \hat{\nu}^2_t + 0.9541 \cdot \hat{\sigma}^2_t
$$ 

이다. IGARCH(1, 1)으로 성공적으로 적합되었으며 이에 따른 위험프리미엄이 있는지 검정해보았다. 검정 결과는 다음과 같다.

#### 3-1-4. 위험 프리미엄 여부 파악

```sas
 /*garch-m*/
proc autoreg data=stock11;
 model asiana_er = kospi_er/nlag=(16)  garch=(p=1,q=1,type=INTEG, mean=SQRT) dist=t;
run;
```

|**모형**||**$\hat{C}$**||**p-value**||**options**|
|:------:|-|:-----------:|-|:---------:|-|:---------:|
|$y_t = x_t\beta + c\cdot h_t + \epsilon_t$||-0.1103||0.2272||LINEAR|
|$y_t = x_t\beta + c\cdot \log(h_t) + \epsilon_t$||-0.5670||0.1593||LOG|
|$y_t = x_t\beta + c\cdot \sqrt{h_t} + \epsilon_t$||-0.5170||0.1822||SQRT|

### 3-2. 최종 모형
## 4. 결과 분석
### 4-1. 각 주식의 속성과 그 비교
### 4-2. 변동성 비교
## 5. 결론
### 5-1. 분석 요약
### 5-2. 차후 과제
## Reference
